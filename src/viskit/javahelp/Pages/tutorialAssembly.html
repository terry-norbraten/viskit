<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<HEAD>
    <TITLE>VisKit Tutorial -- Create Assembly</title>
    <meta http-equiv=Content-Type content="text/html; charset=windows-1252">
    <link rel="stylesheet" type="text/css" href="../basicStyle.css" >
</head>

<body>

<div class=Section1>

<h1 align="center"><a name="Contents">Viskit Tutorial -- Create Assembly</a></h1>

<h2>Contents</h2><ol>
<li><a href='tutorialEvent.html#Intro'>Introduction</a></li>
<li><a href='tutorialEvent.html#Event'>Creating Event Graph</a></li>
<li><a href='#Assembly'>Creating Assembly</a><ol>
<li><a href='#Setup'>Setup</a></li>
<li><a href='#EventEvntParameters'>Event Paramaters</a></li>
<li><a href='#EventStParameters'>State Parameters</a></li>
<li><a href='#EventNodes'>Event Nodes</a></li>
<li><a href='#EventSchedules'>Event Schedules</a></li></ol></li>
</ol>



<h2><a name='Assembly'>3. Creating a Simple Assembly</a></h2>

<h3>3.1. Setup</h3>

<p>It is necessary to have the two event graphs already loaded. The first
graph was created during the Event Graph Tutorial and is called ArrivalProcess.
The second graph is SimpleServer. Both of these can be loaded from the 'examples' 
directory. If you don't have both of these loaded, please do so now.</p>

<p>When the event graphs have correctly loaded, there will be ArrivalProcess 
and SimpleServer icons in the upper left panel under "Event Graphs". This 
indicates they have been imported into the Java classpath and can be used 
to build an assembly. This is indicated in Figure 1.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage001.png"></p>
<p class="caption">Figure 1. Availabiliy of Event Graphs in Assembly Editor.</p>


<h3>3.2. Preview</h3>

<p>First lets see what a finished assembly looks like. Use <span class='menu'>File 
<img src='Tutorial_files/iconMenu.png' width='12' height='9'> Open</span>
and go to examples directory as before (up 3 levels), select and open 
ServerAssembly.xml. You will see the view in Figure 2.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage002.png"></p>
<p class="caption">Figure 2. ServerAssembly.xml in the Assembly Editor.</p>


<p>When you double click on various nodes in the graph a description popup is
displayed. In this case, there are two different types of popups. The blue boxes
display an Event Graph Inspector (see Figure 3). The pink boxes generate a Property
Change Listener (PCL) Inspector (see Figure 4). The popups allow various parameter
to be inspected or modified.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage003.png"></p>
<p class="caption">Figure 3. Event Graph Inspector for the 'sever' event.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage004.png"></p>
<p class="caption">Figure 4. Property Change Listener for 'numAvailServersStat'.</p>



<p>The purpose of the 'Assembly Editor' is to connect the needed event graphs and
establish the proper listeners for the data of interest. Once that is completed, the
simulation is run. This example is now ready to run. That is done by using the 
'Initialize assembly runner' icon <img src='Tutorial_files/iconRun.png' width='28' height='28'>.
Once the button is pressed, Viskit automatically changes tot he 'Assembly Run' tab.
(A full description of the 'Assembly Run' tab is in <a href='tutorialRun.html'>Section 4</a>.)</p>

<p>Click on the VCR Run button <img src='Tutorial_files/iconRun.png' width='28' height='28'>
to start the simulation. The simulation will take several minutes to run. While it is
running you will see a result something like Figure 5. You may choose to de-select the
'Verbose output' check box to reduce the quantity of the output.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage005.png"></p>
<p class="caption">Figure 5. Assembly run screen during a simulation run.</p>



<h3>3.3. Creating an Assembly</h3>

<p>We will now create an assembly. First go back to the 'Assembly Editor' tab. It
is not necessary to delete or otherwise modify the existing ServerAssembly graph.
A new assembly is created with <span class='menu'>File 
<img src='Tutorial_files/iconMenu.png' width='12' height='9'> New Assembly</span>.
The 'Assembly Properties' panel is displayed (see Figure 6). Set the name to
'MyServerAssembly' and the package to 'hello.world', and apply the changes. An empty
assembly graph is now presented to the user.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage006.png"></p>
<p class="caption">Figure 6. New assembly properties panel.</p>


<p>Drag and drop the 'ArrivalProcess(XML) behavior to the assembly graph. For ease
of process, it should go near the upper left. Do the same for the 'SimpleServer(XML)'
behavior to the upper right. Figure 7 shows the process.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage007.png"></p>
<p class="caption">Figure 7. Process of adding behaviors to the assembly.</p>


<p>The two events need to be connected. Select the "Connect Assemblies with Adapter 
Pattern" <img src='Tutorial_files/iconAdapterConnect.png' width='32' height='32'>
icon and draw a line from the "Arrival Process" event to the "Simple Server" event.
This will bring up the "Adapter Connection" popup (see Figure 8).</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage008.png"></p>
<p class="caption">Figure 8. Adapter Connection popup allows you to enter
adapter-specific information.</p>


<p>Select the <img src='Tutorial_files/icon3dot.png' width='22' height='18'> button after "source event", then select "Arrival" from the
popup. Click on "Apply changes" to insert it back into the "Adapter Connection"
window. Follow the same steps for the "target event" field, and click on 
"Apply changes" on the "Adapter Connection" window.</p>

<p>Click on the Select <img src='Tutorial_files/iconSelect.png' width='32' height='32'>
icon, and double-click on the "Arrival Process" event box. That will bring up the
"Event Graph Inspector" (see Figure 9). Now click on the <img src='Tutorial_files/icon3dot.png' width='22' height='18'> button after
simkit.random.RandomVariate field. Set the "method" field to "factory" using 
the drop-down list in the "Object Inspector". Press the 'Enter' key to 
indicate acceptance of the "Factory class" field (see Figure 10). A 
"Factory methods" popup will display (see Figure 11). This window allows you 
to select the actual Java means for generating the values. Choose the entry
<span class='code'>getInstance(java.lang.String,java.lang.Object[],simkit.random.RandomNumber)</span> 
and click "OK" to use.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage009.png"></p>
<p class="caption">Figure 9. Event Graph Inspector window does ???</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage010.png"></p>
<p class="caption">Figure 10. Object Inspector selects means for constructing variable??</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage011.png"></p>
<p class="caption">Figure 11. Java-specific means for generating random variable??</p>


<p>In the field java.lang.String enter <span class='code'>simkit.random.Normal3Variate</span>. 
Click on the <img src='Tutorial_files/icon3dot.png' width='22' height='18'> button after java.lang.Object[]. That brings up the Array Inspector
window. Enter '2' in the field for 'Array length' and press 'Enter'. 
Two new fields will be present in the window (see Figure 13). These fields
are the two parameters that describe a normal distribution. The first paramter
(top field) is the mean. The second paramter (bottom box) is the standard deviation. 
Type <span class='code'>new Double(5.0)</span> in the top of the two new boxes. 
In the bottom box type in <span class='code'>new Double(.5)</span>.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage012.png"></p>
<p class="caption">Figure 12. Define random number generator.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage013.png"></p>
<p class="caption">Figure 13. Normal distribution parameter (mean and standard deviation) entry.</p>


<p>The random number method (simkit.random.RandomNumber) field must be filled in.
Click on the <img src='Tutorial_files/icon3dot.png' width='22' height='18'> button.
Using the drop-down, set the method to 'factory' (see figure 14), then select the simkit.random.RandomVariateFactory
class. The 'Factory methods' dialogue window will popup. Click 'OK'.</p>

<p class=BodyTextCentered><img src="Tutorial_files/assemblyImage014.png"></p>
<p class="caption">Figure 14. Define RandomNumber method.</p>


<p>Don't know what to do next. There appear to be problems in the Object Inspector,
and clicking on 'Apply changes' doesn't popupate the other Object Inspector window.

<p class=BodyTextCentered><img src="Tutorial_files/ZZrandomProblem.png"></p>
<p class="caption">Figure 14. Problem here.</p>



<p>Apply the 
changes to the 'Array Inspector' and 'Object Inspector' dialogue windows. 
To apply the changes to the 'Event Graph Inspector' dialogue window, first click
in the 'description' field, then click on the 'Apply Changes' button.</p>


<hr>
<ol start='27'>
<li>Apply changes until back to Event Graph Inspector dialog. To activate the Apply Changes there, click in the description field. (bug).</li>
<li>Apply changes here.</li>
<li>Now select SimpleServer. Double click on it.</li>
<li>Repeat above steps for setting simkit.random.RandomVariate for the "serviceTime". Make up some numbers as desired for mean and standard deviation. Say 10.0 and 1.0.</li>
<li>for "totalNumberServers" set int to 2.</li>
<li>select in description again due to bug to enable Apply Changes</li>
<li>double click on arrow just to check out</li>
<li><b>Statistics: </b>Add a PropertyChangeListener to keep some statistics</li>
<li>Select the lib/simkit.jar tree in the PropertyChangeListener lower left panel in the Assembly Editor </li>
<li>drill down to simkit.stat directory, drag and drop SimpleStatsTally onto the graph.</li>
<li>Select Mode: (4'th box from left) Pink "Connect propertyChangeListener to SimEntity"</li>
<li>Drag arrow from pink SimpleStatsTally to blue SimpleServer box</li>
<li>Property Change Connection popup box, select "..." after the "property" field.</li>
<li>Select numberInQueue for measuring mean number of items in the service queue.</li>
<li>Apply changes.</li>
<li>Apply changes again to the Property Change Connection dialog.</li>
<li>Check out XML by File->View Saved XML, agree to save somewhere with MyServerAssembly.xml as filename.</li>
<li>See XML of the assembly. This is used to create next step Java.</li>
<li>Check out Java by File->Generate Java Source.</li>
<li>Validate source by selecting "Compile Test", mostly classloading messages from compiler, shows good results. No warnings or error messages like "compile failed".</li>
<li>Time to run. Close java source/ xml panels if desired.</li>
<li>Initialize Assembly Runner button</li>
<li>Run as before.</li>
<li>Done.</li>
</ol>




</div>

</body>

</html>
