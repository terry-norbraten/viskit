<?xml version="1.0" encoding="UTF-8"?>
<project basedir=".." name="Viskit-IDE">
    <import file="../build.xml"/>
    <!-- TODO: edit the following target according to your needs -->
    <!-- (more info: http://www.netbeans.org/kb/41/freeform-config.html#runsingle) -->
    
    <path id="debug.classpath">
    
        <!-- use local JDK for tools.jar -->
        <!-- remember to override your environment variable for -->
        <!-- JAVA_HOME to point to the JDK version you are building -->
        <!-- against. Netbeans sets this in the NETBEANS_HOME/etc/netbeans.conf file -->
        <pathelement location="${env.JAVA_HOME}/lib/tools.jar"/>
    	<pathelement location="${dir.build.classes}"/>
        <pathelement location="${dir.lib}/simkit.jar"/>
        <pathelement location="${dir.lib}/bsh-2.0b4.jar"/>
        <pathelement location="${dir.lib}/jgraph.jar"/>
        <pathelement location="${dir.lib}/actions.jar"/>
        <pathelement location="${dir.lib}/jhall.jar"/>
        <pathelement location="${dir.lib}/jdom.jar"/>
        <pathelement location="${jfreechart.jar}"/>
        <pathelement location="${jcommon.jar}"/>
        <pathelement location="${dir.lib}/jedit.jar"/>
        <pathelement location="${dir.lib}/junit.jar"/>
        <pathelement location="${dir.lib}/commons-beanutils-1.7.0.jar"/>
        <pathelement location="${dir.lib}/commons-codec-1.3.jar"/>
        <pathelement location="${dir.lib}/commons-collections-3.1.jar"/>
        <pathelement location="${dir.lib}/commons-configuration-1.5.jar"/>
        <pathelement location="${dir.lib}/commons-digester-1.6.jar"/>
        <pathelement location="${dir.lib}/commons-lang-2.4.jar"/>
        <pathelement location="${dir.lib}/commons-logging-1.1.jar"/>
        <pathelement location="${log4j.jar}"/>
        <pathelement location="${dir.lib}/looks-1.3.1.jar"/>
        <pathelement location="${dir.lib}/xercesImpl.jar"/>
        <pathelement location="${dir.lib}/xalan.jar"/>
        <pathelement location="${dir.lib}/serializer.jar"/>        
        <pathelement location="${dir.lib}/xmlrpc-2.0.jar"/>
        <path refid="jaxb.classes.path"/>
        <path refid="runtime.extension.classes.path"/>
    </path>
    
    <target name="run-selected-file-in-Viskit">
        <fail unless="run.class">Must set property 'run.class'</fail>
        <!-- This target assumes that viskit.jar is already built -->
        <java classname="${run.class}" failonerror="true" fork="true">
            <classpath>
		<!--pathelement location="${basedir}/Path to your project/build/classes"/-->
                <pathelement location="${basedir}/MyViskitProjects/DefaultProject/build/classes"/>
                <path refid="runtime.classpath"/>
            </classpath>
            <!-- Uncomment for translating and compiling EGs -->
            <!--arg value="Path to your EventGraph here"/>
	    <arg value="${basedir}/MyViskitProjects/DefaultProject/EventGraphs/Friendly/GateGuard.xml"/-->
	    
            <!-- Uncomment for translating and compiling Assemblies-->
            <arg value="-f"/>
	    <!--arg value="Path to your Assembly here"/-->
            <arg value="${basedir}/MyViskitProjects/DefaultProject/Assemblies/atfp/PortOfBaltimoreAssembly.xml"/>
            <jvmarg value="-Djava.endorsed.dirs=${java.endorsed}"/>
        </java>
    </target>
    <!-- To compile single files and update the viskit.jar -->
    <!-- (more info: http://www.netbeans.org/kb/41/freeform-config.html#compilesingle) -->
    <target name="compile-selected-files-in-src">
        <fail unless="files">Must set property 'files'</fail>
	
	<!-- zip*.tmp files generate if netBeans hasn't GC'd in a while -->
	<delete dir="${dir.build.lib}">
	    <include name="*.tmp"/>
	</delete>
        <javac destdir="${dir.build.classes}" includes="${files}" source="1.5" srcdir="src">
            <!-- Reveals generics and deprecation warings -->
            <compilerarg value="${javac.unchecked}"/>
            <compilerarg value="${javac.deprecation}"/>
            <classpath>
                <path refid="runtime.classpath"/>
            </classpath>
        </javac>
        <echo message="${files}"/>
        <jar basedir="${dir.build.classes}" compress="false" destfile="${dist.jar}" update="true"/>
    </target>
    <!-- To update the viskit.jar with AnalystReportXMLtoHTML.xslt -->
    <!-- (more info: http://www.netbeans.org/kb/41/freeform-config.html#compilesingle) -->
    <target name="update-viskit-jar-with-AnalystReportXMLtoHTML-xslt">
        <echo message="${analyst.reports.stylesheet}"/>
        <copy todir="${dir.build.classes}">
            <fileset dir="${basedir}">
                <include name="${analyst.reports.stylesheet}"/>
            </fileset>
        </copy>
        <jar basedir="${dir.build.classes}" compress="false" destfile="${dist.jar}" update="true"/>
    </target>
        
    <target name="debug.quick"  description="Quick debug">
        <fail unless="netbeans.home">This target can only run inside the NetBeans IDE.</fail>
        <nbjpdastart name="Viskit" addressproperty="jpda.address" transport="dt_socket">
            <classpath refid="debug.classpath"/>
            <!-- Optional - If source roots are properly declared in project, should
            wor/home/rmgold/CVS/Viskit/viskit/xsd/assembly/GridRunner.java:683: cannot find symbolk without setting source path.     
            <sourcepath path="debug.sourcepath"/> -->
        </nbjpdastart>
        <java classname="viskit.Splash2" fork="true">
            <arg value="viskit.EventGraphAssemblyComboMain"/>
	    <!--arg value="Your path to an assembly file to initialize Viskit ready to run"/-->
	    <!--arg value="${basedir}/MyViskitProjects/DefaultProject/Assemblies/atfp/IndianIslandWatersideToTarget_assembly.xml"/-->
            <!--arg value="${basedir}/MyViskitProjects/TestFoo/Assemblies/oa3302/ServerAssembly.xml"/-->
            <jvmarg value="-Xdebug"/>
            <jvmarg value="-Xnoagent"/>
            <jvmarg value="-Djava.compiler=none"/>
            <jvmarg value="-Xrunjdwp:transport=dt_socket,address=${jpda.address}"/>
            <jvmarg value="-Dswing.aatext=true"/>
            <jvmarg value="-XX:MaxPermSize=1024m"/>
            <jvmarg value="-client"/>
            <jvmarg value="-Djava.endorsed.dirs=${java.endorsed}"/>
            <classpath refid="debug.classpath"/>
        </java>
    </target>
    
    <target name="debug" depends="compile" description="Debug Project">
        <fail unless="netbeans.home">This target can only run inside the NetBeans IDE.</fail>
        <nbjpdastart name="Viskit" addressproperty="jpda.address" transport="dt_socket">
            <classpath path="debug.classpath"/>
            <!-- Optional - If source roots are properly declared in project, should
            work without setting source path.     
            <sourcepath path="debug.sourcepath"/> -->
        </nbjpdastart>
        <java fork="true" classname="viskit.Main">
            <jvmarg value="-Xdebug"/>
            <jvmarg value="-Xnoagent"/>
            <jvmarg value="-Djava.compiler=none"/>
            <jvmarg value="-Xrunjdwp:transport=dt_socket,address=${jpda.address}"/>
            <classpath refid="debug.classpath"/>
            <jvmarg value="-Djava.endorsed.dirs=${java.endorsed}"/>
        </java>
    </target>
    
</project>
